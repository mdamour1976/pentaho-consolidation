<!--===========================================================================
  This is the build file for the Pentaho Mantle project.
  
  This build file will use the common_build.xml file as the default build
  process and should only override the tasks that need to differ from
  the common build file.
  
  See common_build.xml for more details
============================================================================-->
<project name="Pentaho Reporting Platform Plugin" basedir="." default="default" xmlns:ivy="antlib:org.apache.ivy.ant">

  <!-- Import the common_build.xml file which contains all the default tasks -->
  <import file="./build-res/subfloor-gwt.xml" />

  <!--
      AS STATED ABOVE, THE ONLY TASKS THAT SHOULD EXIST IN THIS BUILD FILE ARE
      THE TASKS THAT NEED TO DIFFER FROM THE DEFAULT IMPLEMENTATION OF THE TASKS
      FOUND IN common_build.xml.
    -->

  <!-- override the subfloor assemble target to do special assembly from the war directory -->
  <target name="assemble" depends="gwt-compile,assemble.init">
    <!--copy todir="${approot.stage.dir}/lib">
      <fileset dir="${lib.dir}" excludes="pentaho-bi-platform-*.jar" />
      <fileset file="${dist.dir}/${ivy.artifact.id}-${project.revision}.jar" />
      <fileset file="${lib.dir}/gwt-user*.jar" />
    </copy-->
    <copy todir="${approot.stage.dir}">
      <fileset dir="${package.resdir}" />
      <fileset dir="${gwt.output.dir}">
        <exclude name=".gwt-tmp/" />
        <exclude name="*-aux/" />
      </fileset>
    </copy>
  </target>

  <target name="install">
    <deltree dir="${install.target-dir}/pentaho-solutions/system/reporting/reportviewer"/>
    <delete failonerror="false" file="${install.target-dir}/pentaho-solutions/system/reporting/plugin.xml"/>
    <delete failonerror="false" file="${install.target-dir}/pentaho-solutions/system/reporting/settings.xml"/>
    <copydir src="bin/gwt/output" dest="${install.target-dir}/pentaho-solutions/system/reporting"/>
    <copydir src="package-res" dest="${install.target-dir}/pentaho-solutions/system/reporting"/>
  </target>

</project>
